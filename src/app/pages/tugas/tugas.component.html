<app-main>
    <div *ngIf="Kuis" class="flex flex-row w-full gap-3 py-3 px-5">
        <!-- List Pertanyaan -->
        <div class="w-2/12 flex flex-col gap-2">
            <div *ngFor="let item of Kuis.pertanyaan; let i = index"
                class="flex flex-row justify-center w-full {{ SelectedIndexPertanyaan == i ? 'bg-orange-200 border border-solid border-white' : 'bg-gray-200' }} rounded-md drop-shadow py-1"
                (click)="handleClickSoal(item, i)">
                <p class="{{ SelectedIndexPertanyaan == i  ? 'text-orange-600' : 'text-gray-500' }} text-xs">
                    Soal Nomor {{ i+1 }}
                </p>
            </div>
        </div>

        <!-- List Pertanyaan -->
        <div class="w-10/12 flex flex-col gap-2 bg-white rounded-lg p-3">
            <div class="flex items-center w-full p-2 mb-0">
                <div class="w-3/12"></div>

                <div
                    class="flex w-3/12 p-2 mx-auto rounded-xl items-center justify-center bg-orange-200 text-orange-600 border border-solid border-white">
                    <p class="text-base font-semibold text-center">
                        {{ Kuis.judul }}
                    </p>
                </div>

                <div class="flex flex-row items-center gap-2">
                    <p class="text-sm text-gray-700 font-semibold">
                        Skor Anda
                    </p>
                    <div
                        class="flex flex-col px-2 py-1 mx-auto rounded-lg items-center justify-center {{ Kuis.skor > 0 && Kuis.skor < 70 ? 'bg-red-200 text-red-600' : 'bg-emerald-200 text-emerald-600' }} border border-solid border-white">
                        <p class="text-sm font-bold text-center">
                            {{ Kuis.skor }}
                        </p>
                    </div>
                </div>

            </div>

            <p *ngIf="SelectedPertanyaan" class="text-sm text-gray-800 font-semibold text-justify leading-none mb-2"
                [innerHTML]="SelectedPertanyaan.pertanyaan">
            </p>

            <div *ngIf="SelectedPertanyaan" class="flex flex-col gap-3">
                <div *ngIf="!handleGetVoiceNoteSoal(SelectedPertanyaan)" class="flex items-center">
                    <textarea rows="5" placeholder="Input jawaban Anda disini" pInputTextarea
                        class="p-inputtext-sm w-full" [(ngModel)]="SelectedPertanyaan.jawaban"></textarea>
                </div>

                <div *ngIf="handleGetVoiceNoteSoal(SelectedPertanyaan)" class="flex w-full items-center">
                    <div *ngIf="!SelectedPertanyaan.jawaban" class="voice-note flex gap-2 mb-2">
                        <p-button severity="info" label="🎙️ Mulai Merekam" styleClass="p-button-sm"
                            (click)="startRecording()" [disabled]="isRecording">
                        </p-button>

                        <p-button severity="secondary" label="🛑 Stop Rekam" styleClass="p-button-sm"
                            (click)="stopRecording(SelectedPertanyaan)" [disabled]="!isRecording">
                        </p-button>
                    </div>

                    <div *ngIf="SelectedPertanyaan.jawaban" class="flex w-full items-center gap-2">
                        <p-button severity="danger" label="Hapus Rekaman" styleClass="p-button-sm"
                            (click)="SelectedPertanyaan.jawaban = ''">
                        </p-button>

                        <audio [src]="SelectedPertanyaan.jawaban" controls></audio>
                    </div>
                </div>
            </div>

            <div *ngIf="SelectedPertanyaan"
                class="flex flex-row {{ SelectedIndexPertanyaan == 0 ? 'justify-end' : 'justify-between'}} mt-auto">
                <p-button *ngIf="SelectedIndexPertanyaan > 0" severity="secondary" styleClass="p-button-sm"
                    icon="pi pi-chevron-left" (onClick)="handleNextPrevSoal('prev')">
                </p-button>

                <p-button *ngIf=" SelectedIndexPertanyaan !=Kuis.pertanyaan.length - 1" severity="secondary"
                    styleClass="p-button-sm" icon="pi pi-chevron-right" (onClick)="handleNextPrevSoal('next')">
                </p-button>

                <p-button
                    *ngIf="SelectedIndexPertanyaan == Kuis.pertanyaan.length - 1 && !SelectedPertanyaan.id_jawaban"
                    severity="info" styleClass="p-button-sm" icon="pi pi-save" label="Simpan"
                    (click)="handleSubmitPertanyaan(Kuis)">
                </p-button>
            </div>
        </div>
    </div>
</app-main>