<app-main>
    <div class="flex flex-row w-full gap-3 py-3 px-5">
        <!-- List Referensi -->
        <div *ngIf="Referensi" class="w-3/12 flex flex-col gap-2">
            <div *ngFor="let item of Referensi; let i = index"
                class="flex flex-row justify-center w-full {{ SelectedReferensiIndex == i ? 'bg-orange-200 border border-solid border-white' : 'bg-gray-200' }} rounded-md drop-shadow py-1"
                (click)="handleClickButtonEdit(item, i)">
                <p class="{{ SelectedReferensiIndex == i  ? 'text-orange-600' : 'text-gray-500' }} text-xs">
                    {{ item.judul }}
                </p>
            </div>
        </div>

        <!-- List Pertanyaan -->
        <div *ngIf="Referensi" class="w-9/12 flex flex-col gap-2 bg-white rounded-lg p-3">
            <div *ngIf="IsGuru" class="flex items-center justify-between w-full p-2 mb-0">
                <div
                    class="flex w-3/12 p-2 rounded-lg items-center justify-center bg-orange-200 text-orange-600 border border-solid border-white">
                    <p class="text-sm font-semibold text-center">
                        Referensi
                    </p>
                </div>

                <div class="flex justify-end gap-3">
                    <p-button *ngIf="IsGuru && !IsShowForm" styleClass="p-button-sm" severity="secondary" label="Tambah"
                        (click)="IsShowForm = true; Form.reset()">
                    </p-button>

                    <p-button *ngIf="IsGuru && IsShowForm && !IsFormEdit" severity="secondary" label="Simpan"
                        styleClass="p-button-sm bg-sky-500 text-white text-sm"
                        (onClick)="handleSaveReferensi(Form.value)">
                    </p-button>

                    <p-button *ngIf="IsGuru && IsShowForm && IsFormEdit" styleClass="p-button-sm" severity="secondary"
                        label="Reset" (click)="IsShowForm = false; Form.reset(); IsFormEdit = false">
                    </p-button>


                    <p-button *ngIf="IsGuru && IsShowForm && IsFormEdit" severity="secondary" label="Update"
                        styleClass="p-button-sm bg-sky-500 text-white text-sm"
                        (onClick)="handleUpdateReferensi(Form.value)">
                    </p-button>
                </div>
            </div>

            <!-- Guru View -->
            <div *ngIf="IsGuru && IsShowForm" [formGroup]="Form" class="flex flex-col gap-3 w-full">
                <!-- Judul -->
                <div class="flex flex-col gap-1 w-full">
                    <p class="text-sm font-medium text-gray-700">
                        Judul Referensi
                        <span class="text-red-500">*</span>
                    </p>
                    <input type="text" pInputText class="w-full p-inputtext-sm"
                        placeholder="Masukkan judul referensi disini" formControlName="judul">

                    <span *ngIf="Form.get('judul')?.touched && Form.get('judul')?.invalid"
                        class="p-2 rounded-lg bg-red-100 text-red-500 font-semibold text-xs">
                        Judul referensi tidak boleh kosong
                    </span>
                </div>

                <!-- Deskripsi -->
                <div class="flex flex-col gap-1 w-full">
                    <p class="text-sm font-medium text-gray-700">
                        Deskripsi Referensi
                        <span class="text-red-500">*</span>
                    </p>
                    <textarea pInputTextarea class="w-full p-inputtext-sm" rows="3"
                        placeholder="Masukkan deskripsi referensi disini" formControlName="deskripsi"></textarea>

                    <span *ngIf="Form.get('deskripsi')?.touched && Form.get('deskripsi')?.invalid"
                        class="p-2 rounded-lg bg-red-100 text-red-500 font-semibold text-xs">
                        Deskripsi referensi tidak boleh kosong
                    </span>
                </div>

                <!-- Link -->
                <div class="flex flex-col gap-1 w-full">
                    <p class="text-sm font-medium text-gray-700">
                        Link Referensi
                        <span class="text-red-500">*</span>
                    </p>
                    <input type="text" pInputText class="w-full p-inputtext-sm"
                        placeholder="Masukkan link referensi disini" formControlName="link">

                    <span *ngIf="Form.get('link')?.touched && Form.get('link')?.invalid"
                        class="p-2 rounded-lg bg-red-100 text-red-500 font-semibold text-xs">
                        Link referensi tidak boleh kosong
                    </span>
                </div>
            </div>

            <!-- Siswa View -->
            <div *ngIf="!IsGuru && SafeUrl" class="flex flex-col w-full">
                <iframe width="100%" height="315" [src]="SafeUrl" title="YouTube video player" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    referrerpolicy="strict-origin-when-cross-origin" allowfullscreen>
                </iframe>
            </div>
        </div>
    </div>
</app-main>